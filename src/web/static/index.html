<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Car Condition</title>
  <link rel="icon" href="/static/favicon.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <header>
    <div class="header-row">
      <div>Состояние авто — чистота и повреждения</div>
      <div style="display:flex; gap:8px; align-items:center">
        <button id="themeBtn" class="mini-btn" type="button">Тема: Тёмная</button>
        <button id="helpBtn" class="mini-btn" type="button" aria-haspopup="dialog" aria-controls="helpModal" title="Справка (нажмите ?)">Справка</button>
        <button id="bgBtn" class="mini-btn" type="button" title="Переключить насыщенность фона">Фон: Высокий</button>
      </div>
    </div>
  </header>
  <main>
    <div class="row">
      <div class="card">
        <h1>Загрузка фото</h1>
        <p>Загрузите одно или несколько изображений автомобиля (JPG/PNG/BMP).</p>
        <div id="drop" class="dropzone" title="Перетащите изображения сюда или кликните" role="button" tabindex="0" aria-label="Загрузка изображений: перетащите сюда или нажмите Enter">
          <div class="icon">⬆</div>
          <div class="text">Перетащите сюда фото или кликните для выбора</div>
        </div>
        <input id="fileInput" type="file" accept="image/*" multiple class="hidden" />
        <div style="height: 12px;"></div>
        <div class="line" style="gap:10px">
          <button id="sendBtn" aria-label="Отправить изображения на анализ">Отправить</button>
          <button id="clearBtn" style="background:#243026; color:#cde8d9; border-color:#2a6b46" aria-label="Очистить выбранные изображения">Очистить</button>
        </div>
        <div style="height: 12px;"></div>
        <div class="conf-wrap">
          <h2>Чувствительность детектора</h2>
          <div class="muted">Если объектов мало — сдвиньте влево.</div>
          <input id="confSlider" type="range" min="0.01" max="0.50" step="0.01" />
          <div class="muted">Порог: <span id="confValue">0.05</span></div>
        </div>
        <div class="legend">
          <span class="chip dirt">грязь — зелёный</span>
          <span class="chip scratch">царапина — жёлтый</span>
          <span class="chip dent">вмятина — оранжевый</span>
          <span class="chip rust">ржавчина — красный</span>
        </div>
        <div class="controls">
          <label class="switch"><input id="optFill" type="checkbox" checked /> Закрашивать области</label>
          <label class="switch"><input id="optLabels" type="checkbox" checked /> Подписи на боксах</label>
          <label class="switch" title="Фильтр: грязь"><input id="fltDirt" type="checkbox" checked /> Грязь</label>
          <label class="switch" title="Фильтр: царапина"><input id="fltScratch" type="checkbox" checked /> Царапина</label>
          <label class="switch" title="Фильтр: вмятина"><input id="fltDent" type="checkbox" checked /> Вмятина</label>
          <label class="switch" title="Фильтр: ржавчина"><input id="fltRust" type="checkbox" checked /> Ржавчина</label>
          <label class="switch" title="Фильтр: повреждение"><input id="fltDamage" type="checkbox" checked /> Повреждение</label>
          <label class="switch" title="Размер входа YOLO (опционально)"><input id="imgszInput" type="number" min="320" max="1536" step="32" style="width:88px" placeholder="imgsz" /> imgsz</label>
        </div>
      </div>
      <div class="card">
        <h1>Результаты</h1>
        <div id="meta" class="muted" style="margin-bottom:8px;"></div>
        <div id="preview"></div>
        <div style="height: 12px;"></div>
        <div id="labels" class="grid"></div>
        <div style="height: 12px;"></div>
      </div>
    </div>
  </main>
  <div id="busy" class="busy hidden" role="dialog" aria-live="polite" aria-busy="true"><div><div class="spinner" style="margin:auto"></div><div class="muted" style="margin-top:10px; text-align:center">Обработка…</div></div></div>
  <div id="toasts" class="toasts" aria-live="polite"></div>

  <!-- Help Modal -->
  <div id="helpModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="helpTitle">Справка и горячие клавиши</h2>
        <button id="helpClose" class="mini-btn" aria-label="Закрыть справку">✕</button>
      </div>
      <div class="modal-body">
        <ul>
          <li><b>T</b>: переключить тему</li>
          <li><b>L</b>: показать/скрыть подписи</li>
          <li><b>F</b>: включить/выключить заливку</li>
          <li><b>D</b>: скачать текущий холст</li>
          <li><b>?</b>: открыть/закрыть это окно</li>
          <li><b>Enter</b> на дропзоне: открыть выбор файлов</li>
        </ul>
      </div>
    </div>
  </div>

  <script src="/static/app.js" defer></script>
</body>
</html>