/* Theme variables */
:root{
  --bg:#0E0E0E;
  --bg-2:#121212;
  --panel:#171A18;
  --panel-2:#1E241F;
  --stroke:#242D27;
  --stroke-2:#2D3A32;
  --text:#E0E0E0;
  --heading:#FFFFFF;
  --muted:#A8B3AD;
  --accent:#00C853;
  --accent-d:#00A859;
  --warning:#FFC107;
  --rust:#F44336;
  --dent:#FF6F00;
  --scratch:#FFD54F;
  --shadow: 0 10px 26px rgba(0,0,0,0.35), 0 2px 8px rgba(0,0,0,0.22);
  --radius:14px;
}
:root[data-theme="light"]{
  --bg:#F5F7F6;
  --bg-2:#FFFFFF;
  --panel:#FFFFFF;
  --panel-2:#F1F4F2;
  --stroke:#D8E2DB;
  --stroke-2:#C8D5CE;
  --text:#1A1D1B;
  --heading:#0A0D0B;
  --muted:#5E6B65;
  --accent:#00B84A;
  --accent-d:#009A40;
  --rust:#D84335;
  --dent:#E66A00;
  --scratch:#E6C44F;
  --shadow: 0 6px 18px rgba(0,0,0,0.08), 0 2px 6px rgba(0,0,0,0.06);
}
*{box-sizing:border-box}
body{
  font-family: Inter, Roboto, system-ui, Segoe UI, Arial, sans-serif;
  background: radial-gradient(1200px 900px at 10% 10%, rgba(0,200,83,0.08), transparent 60%),
              radial-gradient(1000px 800px at 90% 100%, rgba(0,200,83,0.06), transparent 65%),
              linear-gradient(180deg, #0B0B0B 0%, #0F1A14 100%);
  color: var(--text); margin:0; position: relative; overflow-x: hidden;
}
header{
  position:sticky; top:0; z-index:10; padding: 16px 24px;
  background: linear-gradient(180deg, rgba(23,26,24,0.95), rgba(23,26,24,0.88));
  border-bottom:1px solid var(--stroke); font-weight:800; letter-spacing:0.1px
}
header{ backdrop-filter: blur(8px); background: linear-gradient(180deg, rgba(23,26,24,0.75), rgba(23,26,24,0.68)); }
:root[data-theme="light"] header{ background: linear-gradient(180deg, rgba(255,255,255,0.75), rgba(255,255,255,0.68)); backdrop-filter: blur(8px); }
.header-row{ display:flex; align-items:center; gap:12px; justify-content:space-between }
.mini-btn{ background:#1b221d; color:#e8fff2; border:1px solid var(--stroke); padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:700 }
.mini-btn:hover{ filter:brightness(1.05) }
:root[data-theme="light"] .mini-btn{ background:#eef5f0; color:#163b28 }
main{ max-width: 1040px; margin: 28px auto; padding: 0 20px; background: transparent; position: relative; z-index: 1 }
.row{ display:flex; gap: 24px; flex-wrap:wrap }
.card{ flex: 1 1 360px; background: linear-gradient(180deg, color-mix(in oklab, var(--panel) 88%, transparent), color-mix(in oklab, var(--panel-2) 88%, transparent)); backdrop-filter: saturate(1.2) blur(6px); border: 1px solid color-mix(in oklab, var(--stroke) 70%, transparent); border-radius: var(--radius); padding: 22px; box-shadow: 0 18px 40px rgba(0,0,0,0.35) }
h1{ margin:0 0 12px; font-size:20px; font-weight:800; color:var(--heading) }
h2{ margin:0 0 8px; font-size:15px; color: var(--muted); font-weight:700 }
input[type=file]{ padding:12px; width:100%; color: var(--muted); background: #121512; border:1px dashed var(--stroke); border-radius:12px; outline:none; transition: .2s border-color, .2s background }
input[type=file]:hover{ border-color: #345243; background:#151A16 }
button{ background: var(--accent); color:#0b120e; border: 1px solid #174f31; padding: 12px 18px; border-radius: 12px; cursor: pointer; font-weight:800; box-shadow: 0 6px 18px rgba(0,200,83,0.20); transition: .15s transform, .2s filter }
button:hover{ filter: brightness(1.02); background: var(--accent-d) }
button:active{ transform: translateY(1px) }
button:disabled{ opacity:.75; cursor: progress }
.result{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; background: #121612; border:1px solid var(--stroke); border-radius: 12px; padding:12px; white-space: pre-wrap; box-shadow: inset 0 0 0 1px rgba(255,255,255,0.02) }
.grid{ display:grid; grid-template-columns: repeat(2,1fr); gap: 12px }
@media (max-width: 900px){ .grid{ grid-template-columns: 1fr } }
.badge{ display:inline-flex; align-items:center; gap:6px; padding: 6px 10px; border-radius: 999px; background: #171A18; border: 1px solid var(--stroke-2); color: #EAF7F0; font-weight:700 }
.badge.ok{ background: rgba(0,200,83,0.13); border-color: #2a6b46; color: #baf7d3 }
.badge.bad{ background: rgba(244,67,54,0.15); border-color: #7a2929; color: #ffc1c1 }
.file{ font-weight:800; margin-bottom:6px; color: #F2F2F2 }
.line{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin-bottom:10px }
.muted{ color: var(--muted); font-size: 12px }
.legend{ display:flex; gap:8px; flex-wrap:wrap; margin-top:6px }
.chip{ padding:4px 9px; border-radius: 999px; border: 1px solid var(--stroke-2); background: #0f1512; font-size: 12px; color:#d8efe4 }
.chip.dirt{ border-color: #2b7f50; color: #b7ffd7 }
.chip.scratch{ border-color: #7a6a2a; color: #ffe08a }
.chip.dent{ border-color: #5f4529; color: #ffcf9e }
.chip.rust{ border-color: #7a2e2e; color: #ffb2b2 }
.chip.damage{ border-color: #1b7a56; color: #c6ffe6 }
.conf-wrap{ margin-top:10px }
.conf-wrap input[type=range]{ width:100%; appearance: none; height: 8px; background: linear-gradient(90deg, rgba(0,200,83,0.28), rgba(0,200,83,0.08)); border:1px solid var(--stroke); border-radius: 999px; outline:none }
.conf-wrap input[type=range]::-webkit-slider-thumb{ appearance:none; width:18px; height:18px; border-radius:50%; background: #00C853; border:2px solid #00a746; box-shadow: 0 3px 10px rgba(0,200,83,0.28) }
.conf-wrap input[type=range]::-moz-range-thumb{ width:18px; height:18px; border-radius:50%; background: #00C853; border:2px solid #00a746; box-shadow: 0 3px 10px rgba(0,200,83,0.28) }
canvas.det{ border:1px solid var(--stroke) !important; box-shadow: 0 6px 18px rgba(0,0,0,0.25); background:#0c0f0d }
.hidden{ display:none !important }
/* Dropzone */
.dropzone{ border: 1px dashed var(--stroke); background: #121512; border-radius: 12px; padding: 16px; display:flex; gap:10px; align-items:center; justify-content:center; color: var(--muted); cursor: pointer; transition: .2s border-color, .2s background }
.dropzone:hover{ border-color: #345243; background:#151A16 }
.dropzone.dragover{ border-color: var(--accent); background: #122016 }
.dropzone .icon{ width: 28px; height: 28px; border-radius: 8px; background: rgba(0,200,83,0.08); display:flex; align-items:center; justify-content:center; color: var(--accent); font-weight:800 }
.dropzone .text{ font-weight:700 }
/* Switches */
.controls{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px }
.switch{ display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border:1px solid var(--stroke); border-radius:999px; background:#111512; color:var(--text) }
.switch input{ width:18px; height:18px }
/* Canvas wrapper with download */
.canvas-wrap{ position: relative; display: inline-block; width: 100% }
.dl{ position:absolute; right:8px; top:8px; background: rgba(0,0,0,0.55); border:1px solid var(--stroke); color:#eaeaea; padding:6px 10px; border-radius:999px; font-size:12px; cursor:pointer }
.dl:hover{ filter: brightness(1.05) }
/* Toasts */
.toasts{ position: fixed; right: 16px; bottom: 16px; display:flex; flex-direction:column; gap:8px; z-index: 50 }
.toast{ background:#111512; color:#eaeaea; border:1px solid var(--stroke); border-left:3px solid var(--accent); padding:10px 12px; border-radius:10px; max-width: 340px; box-shadow: var(--shadow) }
.toast.err{ border-left-color: var(--rust) }
/* Busy overlay */
.busy{ position: fixed; inset:0; background: rgba(0,0,0,0.45); display:flex; align-items:center; justify-content:center; z-index: 40 }
.spinner{ width:44px; height:44px; border:4px solid rgba(255,255,255,0.2); border-top-color: var(--accent); border-radius:50%; animation: spin 1s linear infinite }
@keyframes spin{ to{ transform: rotate(360deg) } }
/* Modal */
.modal{ position: fixed; inset:0; display:flex; align-items:center; justify-content:center; background: rgba(0,0,0,0.5); z-index: 60 }
.modal-content{ width: min(680px, 92vw); background: var(--panel); border:1px solid var(--stroke); border-radius: 12px; box-shadow: var(--shadow) }
.modal-header{ display:flex; align-items:center; justify-content:space-between; padding: 12px 14px; border-bottom:1px solid var(--stroke) }
.modal-body{ padding: 12px 16px; color: var(--text) }
/* Background decoration */
body::before{
  content:""; position: fixed; inset: 0; pointer-events: none; z-index: 0; opacity: 0.9;
  background:
    radial-gradient(40vw 40vw at 0% 20%, rgba(0,200,83,0.12), transparent 60%),
    radial-gradient(50vw 46vw at 100% 80%, rgba(0,200,83,0.10), transparent 62%),
    conic-gradient(from 0deg at 20% 30%, rgba(0,200,83,0.05), transparent 50%),
    conic-gradient(from 180deg at 80% 70%, rgba(255,255,255,0.04), transparent 50%);
  animation: floatBG 24s ease-in-out infinite alternate;
}
body::after{
  content:""; position: fixed; inset: 0; pointer-events: none; z-index: 0; opacity: 0.35;
  background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="0 0 120 120"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="3" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.35"/></svg>');
  mix-blend-mode: overlay;
}
@keyframes floatBG{ 0%{ transform: translateY(0) scale(1)} 100%{ transform: translateY(-2%) scale(1.02)} }

/* Background intensity toggle */
:root[data-bg='light'] body::before{ opacity: 0.6; }
:root[data-bg='light'] body::after{ opacity: 0.18; }
.mini-btn:focus-visible{ outline: 2px solid var(--accent); outline-offset: 2px }
